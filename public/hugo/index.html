<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="utf-8">
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	<title> Hugo &middot; Blackhole </title>

	
	<link rel="stylesheet" href="http://localhost:1313/css/bootstrap.min.css">
	<link rel="stylesheet" href="http://localhost:1313/css/bootstrap-theme.css">
	<link rel="stylesheet" href="http://localhost:1313/css/style.css">

	
	<link rel="shortcut icon" href="/favicon.ico">

	
	<link href="" rel="alternate" type="application/rss+xml" title="Blackhole" />
</head>
<body>

<nav class="navbar navbar-default" role="navigation">
	<div class="container-fluid">
		
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="/">Blackhole</a>
		</div>

		
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
			
				<li ><a href="">about hugo</a></li>
			
				<li ><a href="http://www.bing.com">getting-started</a></li>
			
				<li ><a href="http://localhost:1313/usage">Usage</a></li>
			
				<li ><a href="http://localhost:1313/configuration">Config</a></li>
			
				<li ><a href="http://localhost:1313/about">About</a></li>
			
				<li ><a href="http://localhost:1313/help">Help</a></li>
			
				<li class="active"><a href="http://localhost:1313/hugo">Hugo</a></li>
			
			</ul>
		</div>
	</div>
</nav>

	

	

	

	

	

	

	



<div class="content container">
	<div class="post">
	<h1>Hugo</h1>
	<span class="post-date">Sat, Jul 19, 2014</span>
	<div>
		<nav id="TableOfContents">
<ul>
<li><a href="#toc_0">快速建站之静态网站生成篇</a>
<ul>
<li><a href="#toc_1">hugo</a></li>
<li><a href="#toc_2">快速上手</a>
<ul>
<li><a href="#toc_3">下载</a></li>
<li><a href="#toc_4">建立网站</a></li>
<li><a href="#toc_5">添加内容</a></li>
<li><a href="#toc_6">安装样式</a></li>
<li><a href="#toc_7">运行测试server</a></li>
</ul></li>
<li><a href="#toc_8">进阶</a>
<ul>
<li><a href="#toc_9">模版选择</a>
<ul>
<li><a href="#toc_10">正文</a></li>
<li><a href="#toc_11">列表页</a></li>
<li><a href="#toc_12">主页</a></li>
</ul></li>
<li><a href="#toc_13">分类</a></li>
<li><a href="#toc_14">代码高亮</a></li>
<li><a href="#toc_15">菜单</a>
<ul>
<li><a href="#toc_16">1a. 在站点配置文件中声明菜单。</a></li>
<li><a href="#toc_17">1b. 在正文的元数据中声明内容所属的菜单。</a></li>
</ul></li>
<li><a href="#toc_18">发布到Github Pages</a>
<ul>
<li><a href="#toc_19">先去github点Create Repository建立新点仓库xxx。</a></li>
<li><a href="#toc_20">回到本地</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
	</div>
	<div>
		

<h1 id="toc_0">快速建站之静态网站生成篇</h1>

<p>建一个网站是一件十分麻烦的事情，即使对于我们这些互联网专业人士也同样。
有些时候，我们想用最快的方式建一个网站，把内容放到互联网上。</p>

<p>CMS系统其实就是为了达到这样的目的。那为什么不用CMS呢？
使用CMS意味着你需要一台server，还要搭建DB，运行环境等，这些都要花时间。
就不能更简单一些么？于是，有了静态网站生成器。它用一个最实际的特性 <strong>简单</strong>，解决了一个建站的最大的实际问题： <strong>懒！</strong></p>

<p>使用静态网站生成器，用户一般需要把内容放在不同的文本文件里，格式常见的有markdown，resturectedText等（完全没有db）。然后，通过命令行工具生成网站所有的html文件。这些html文件放到server上即可使用，不需要复杂的后台技术。这意味着随便搞个server几乎都可以部署，发布<strong>简单</strong> ， 空间流量十分 <strong>便宜</strong> 。由于github提供了github pages静态页面服务，每个人几乎都可以 <strong>免费</strong> 搭建自己的站点。</p>

<p>当然并不是所有的项目都适合静态网站生成器。静态网站生成器一般适合多读少写，以内容为主的项目。如：个人博客，github项目介绍，程序API文档等。
使用静态网站生成的有名的站点列举一些，如：<a href="http://www.getbootstrap.com">http://www.getbootstrap.com</a>,  <a href="https://training.github.com/">https://training.github.com/</a></p>

<h2 id="toc_1">hugo</h2>

<p>常用的静态网站生成器很多，Jekyll, Octopress最为流行。还有更多可以参考这里的<a href="https://www.staticgen.com/">详细列表</a>。这里介绍一个优秀的静态网站生成器 &ndash; hugo。</p>

<p>hugo有以下优点：</p>

<ul>
<li><p>编译后， <em>只有一个二进制文件。没有任何依赖</em> 。</p>

<p>Jekyll, Octopress都是ruby搞的，个人而言，无法忍受安装ruby只为搞这个。其他基于python，nodejs的也都要安装解释器、安装依赖库！</p></li>

<li><p>Go语言是编译语言，运行效率高。页面生成速度最快。</p></li>

<li><p>Windows, linux, mac兼容</p></li>

<li><p>易于配置，功能强大</p></li>

<li><p>修改内容后支持liveReload</p></li>
</ul>

<h2 id="toc_2">快速上手</h2>

<h3 id="toc_3">下载</h3>

<p>先去<a href="http://hugo.spf13.com/">hugo</a>网站上下个包吧，三大平台都打包好的一个文件。</p>

<p>下完之后麻烦放到PATH路径下面哦。</p>

<h3 id="toc_4">建立网站</h3>

<pre><code>hugo new site MySite
</code></pre>

<p>hugo会为你生成以下的文件结构。</p>

<pre><code>▸ content/      内容
▸ layouts/      模版
▸ static/       静态文件js, css
▸ archetypes/   针对类型的内容配置
  config.toml   站点的配置文件，也可以用yaml, json格式
</code></pre>

<h3 id="toc_5">添加内容</h3>

<pre><code>hugo new about.md
</code></pre>

<p>hugo为你在content目录下生成了一个文件，目前只有这个内容的元数据。</p>

<pre><code>+++
draft = true
title = &quot;about&quot;
date = 2014-05-20T10:04:31Z
+++
</code></pre>

<p>我们写些内容进去吧! markdown内容跟在文件后面就行了。 <a href="http://daringfireball.net/projects/markdown/basics">markdown的语法</a>详见这里。</p>

<pre><code>+++
draft = true
title = &quot;about&quot;
date = 2014-05-20T10:04:31Z
+++

# 标题
Hello, world!
</code></pre>

<h3 id="toc_6">安装样式</h3>

<p>默认的hugo项目是没有样式的，俺们安装一些预设的样式。</p>

<pre><code>git clone --recursive https://github.com/spf13/hugoThemes themes
</code></pre>

<h3 id="toc_7">运行测试server</h3>

<pre><code>hugo server --theme=hyde --buildDrafts
2 pages created
0 tags created
0 categories created
in 5 ms
Serving pages from exampleHugoSite/public
Web Server is available at http://localhost:1313
Press ctrl+c to stop
</code></pre>

<p>恭喜！你的站点好了。用浏览器打开<a href="http://localhost:1313">http://localhost:1313</a> 看下吧</p>

<h2 id="toc_8">进阶</h2>

<p>现在制作的hugo站点是默认的样式，要在实际项目中用，学习自定义模版是必须的。</p>

<p>hugo生成页面的时候有以下一些流程:</p>

<ol>
<li><p>copy静态资源到public文件夹，包括：
copy theme/static/* 到 public/下; copy static/* 到 public/下</p></li>

<li><p>遍历所有content/下所有文件
获取文件头信息，并把正文markdown转换为html</p>

<p>注：rst格式使用rst2html.py转换rst，使用rst需要安装python docutils</p></li>

<li><p>渲染生成每个页面对应的正文页面，生成文件夹对应的列表页面，生成分类页面，生成主页</p></li>
</ol>

<p>每个静态页面生成的时候需要两个东西，一个模版，一个结构体数据。</p>

<h3 id="toc_9">模版选择</h3>

<p>hugo会从layouts文件夹下一系列路径寻找第一个文件作为模版，这样方便对不同的页面模版进行定制。</p>

<p>例如：正文渲染会依次从以下一些位置寻找模版。首先是layouts文件夹，然后再在themes下面的layouts文件夹寻找。</p>

<ul>
<li>/layouts/<code>TYPE</code> or <code>SECTION</code>/<code>LAYOUT</code>.html</li>
<li>/layouts/<code>TYPE</code> or <code>SECTION</code>/single.html</li>
<li>/layouts/_default/single.html</li>
<li>/themes/<code>THEME</code>/layouts/<code>TYPE</code> or <code>SECTION</code>/<code>LAYOUT</code>.html</li>
<li>/themes/<code>THEME</code>/layouts/<code>TYPE</code> or <code>SECTION</code>/single.html</li>
<li>/themes/<code>THEME</code>/layouts/_default/single.html</li>
</ul>

<p>我们最常使用的模版是以下三个：</p>

<ul>
<li>正文页：/layouts/_default/single.html</li>
<li>列表页：/layouts/_default/list.html</li>
<li>主页：/layouts/index.html</li>
</ul>

<h4 id="toc_10">正文</h4>

<p>hugo使用的模版语言是go自带的template系统。详细的语法可以参考<a href="http://hugo.spf13.com/templates/go-templates">这里</a>。</p>

<p>正文渲染使用hugolib/page.go中的Page结构体。Page结构体主要的属性包括：
- Title标题
- Summary摘要
- Content正文
- TableOfContents目录
- &hellip;</p>

<p>有兴趣的同学可以看下这个文件。</p>

<p>例如：一个很简单的正文片段如下。我们把文件放到/layouts/_default/single.html。</p>

<pre><code>{{ template &quot;partial/header.html&quot; . }}
{{ template &quot;partial/menu.html&quot; . }}

&lt;div class=&quot;content container&quot;&gt;
&lt;div class=&quot;post&quot;&gt;
    &lt;h1&gt;{{ .Title }}&lt;/h1&gt;
        &lt;span class=&quot;post-date&quot;&gt;{{ .Date.Format &quot;Mon, Jan 2, 2006&quot; }}&lt;/span&gt;
        {{ .Content }}
    &lt;/div&gt;
&lt;/div&gt;

{{ template &quot;partial/footer.html&quot; . }}
</code></pre>

<p>注意，这里使用template语句把常用的模块分散，如页头，页尾，菜单。</p>

<h4 id="toc_11">列表页</h4>

<p>对于每个文件夹，hugo会生成列表页，显示下面的所有内容的列表。列表页使用 <code>hugolib/node.go</code> 文件中定义的Node结构体渲染页面。</p>

<p>该结构体有两个属性：</p>

<ul>
<li>Site代表站点配置信息，是位于hugolib/site.go中定义的SiteInfo结构体。</li>
<li>Data是节点数据，其Pages属性表示子页面的列表。</li>
</ul>

<p>如下的/layouts/_default/list.html文件对Data.Pages进行了循环，渲染了该文件夹中所有的文件。</p>

<pre><code>{{ template &quot;partial/header.html&quot; . }}
{{ template &quot;partial/menu.html&quot; . }}

&lt;div class=&quot;content container&quot;&gt;
    &lt;ul class=&quot;posts&quot;&gt;
    {{ range .Data.Pages }}
    &lt;li&gt;
    &lt;a href=&quot;{{ .Permalink }}&quot;&gt;&lt;h4&gt;{{ .Title }}&lt;/h4&gt;&lt;/a&gt;&lt;time class=&quot;pull-right post-list&quot;&gt;{{ .Date.Format &quot;Mon, Jan 2, 2006&quot; }}&lt;/time&gt;
    &lt;/li&gt;
    {{ end }}
    &lt;/ul&gt;
&lt;/div&gt;

{{ template &quot;partial/footer.html&quot; . }}
</code></pre>

<h4 id="toc_12">主页</h4>

<p>主页其实也是一个列表文件。渲染数据和列表页结构相同，都是Node结构体。只是模版优先选择<code>/layouts/index.html</code>文件
这里就不再赘述了。</p>

<h3 id="toc_13">分类</h3>

<p>hugo除了正文，列表，主页三种页面。还支持分类页面tags, categories。</p>

<p>使用时简单的在正文元数据定义下ok。</p>

<pre><code>tags:
    - &quot;javascript&quot;
    - &quot;python&quot;
    - &quot;go&quot;
categories:
    - &quot;hugo&quot;
    - &quot;fun&quot;
    - &quot;test&quot;
</code></pre>

<h3 id="toc_14">代码高亮</h3>

<p>码农必备！hugo使用的python的pygment进行语法高亮的。需要先安装python pygment。</p>

<pre><code>{{ % highlight javascript %}}
var b = function () {
    console.log(123);
};
{{ % /highlight %}}
</code></pre>

<p>这语法时hugo的shortcode，还可以搞其他的东西，相当于一个内容插件。</p>

<h3 id="toc_15">菜单</h3>

<p>hugo的菜单系统支持菜单有两种使用方式：</p>

<h4 id="toc_16">1a. 在站点配置文件中声明菜单。</h4>

<p>如下的yaml文件定义了一个main菜单，和两个菜单条目。</p>

<pre><code>menu:
    main:
      - name: &quot;about hugo&quot;
        pre: &quot;&lt;i class='ico ico-heart'&gt;&lt;/i&gt;&quot;
        weight: -110
        identifier: &quot;about&quot;
      - name: &quot;getting-started&quot;
        pre: &quot;&lt;i class='ico ico-road'&gt;&lt;/i&gt;&quot;
        weight: -110
        url: http://www.bing.com
</code></pre>

<h4 id="toc_17">1b. 在正文的元数据中声明内容所属的菜单。</h4>

<p>加入到单个菜单</p>

<pre><code>---
menu = &quot;main&quot;
---
</code></pre>

<p>加入到多个菜单</p>

<pre><code>---
menu: [&quot;main&quot;, &quot;footer&quot;]
---
</code></pre>

<p>菜单定义好了以后就可以在模版中通过循环显示菜单列表。</p>

<pre><code>{{ $currentNode := . }}
&lt;ul class=&quot;nav navbar-nav&quot;&gt;
{{ range .Site.Menus.main }}
&lt;li {{if or ($currentNode.HasMenuCurrent &quot;main&quot; .) ($currentNode.IsMenuCurrent &quot;main&quot; .) }}class=&quot;active&quot;{{end}}&gt;&lt;a href=&quot;{{.Url}}&quot;&gt;{{ .Name }}&lt;/a&gt;&lt;/li&gt;
{{end}}
&lt;/ul&gt;
</code></pre>

<h3 id="toc_18">发布到Github Pages</h3>

<p>使用静态网站生成器一个很重要的优点是可以免费部署在github!
接下来我们就来看下。</p>

<p>Github pages一般有两种使用。一个是项目的主页，另一种是个人/机构的主页，这种一个用户只能建一个。
作为项目的主页，项目的版本库需要一个命名为gh-pages的分支。这个分支是网站根目录。
作为个人主页，个人需要有一个以自己的名字命名的仓库，其master分支是跟目录。例如：用户名gliheng,仓库gliheng.github.io将是主页的仓库。</p>

<p>这样我们只需要把编译出来的静态文件（/public文件夹）丢到某个仓库的某个分支即可。</p>

<p>我们来试试个人博客。</p>

<h4 id="toc_19">先去github点Create Repository建立新点仓库xxx。</h4>

<p>记得勾上<code>Initialize this repository with a README</code></p>

<h4 id="toc_20">回到本地</h4>

<p>把本地的source分支推到remote的source分支。
把public文件夹的文件推到remote的master分支。</p>

<pre><code>hugo new site xxx
cd xxx

git init
git checkout --orphan source

git add .
# 把代码提交到source分支吧
git commit -m &quot;Initial submit&quot;

git remote add origin git@github.com:gliheng/xxx.git
git pull

# 建立本地master分支
git branch master
# 把master作为source分支的子目录了
git subtree add --prefix public git@github.com:gliheng/xxx.git master --squash

# 添加一个文章，编辑一下
hugo new blog/first.md
# 生成public下的站点
hugo

# 把source分支推到github的source分支
git push origin source
# 把public文件夹推到github的master分支
git subtree push --prefix=public git@github.com:gliheng/xxx.git master
</code></pre>

<p>搞定！访问yourname.github.io看下吧。</p>

	</div>
	</div>
</div>

<div class="footer">
	<div class="container">&copy; 2015. All rights reserved. </div>
</div>

<script src="http://localhost:1313/js/jquery-2.1.1.min.js"></script>
<script src="http://localhost:1313/js/bootstrap.min.js"></script>
<script>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>

